# SecurityDatasets GoldenSAML Microsoft365DefenderEvents.json to OSCF mapping


# endpoint: see https://schema.ocsf.io/1.1.0/objects/endpoint
endpoint: &endpoint
    hostname: DeviceName
    uid: DeviceId


file: &file
    endpoint: *endpoint  # FIXME: should be device?
    name: FileName


# https://schema.ocsf.io/1.1.0/objects/process
process:
    endpoint: *endpoint
    cmd_line: InitiatingProcessCommandLine
    pid: InitiatingProcessId
    file:
        name: InitiatingProcessFileName
        path: InitiatingProcessFolderPath
        parent_folder:
            native_field: InitiatingProcessFolderPath
            native_op: LIKE
            native_value: winpath_startswith
            ocsf_value: dirname


# src_endpoint: see https://schema.ocsf.io/1.1.0/objects/endpoint
src_endpoint: &src_ref
    ip: IPAddress
    port: Port


# dst_endpoint: see https://schema.ocsf.io/1.1.0/objects/endpoint
dst_endpoint: &dst_ref
    ip: DestinationIPAddress
    port: DestinationPort


# https://schema.ocsf.io/1.1.0/objects/user
user: &user
    domain: AccountDomain
    name: AccountName
    uid: AccountSid


# https://schema.ocsf.io/1.1.0/classes/network_activity
# Network Activity [4001] Class
network_activity:
    src_endpoint: *src_ref
    dst_endpoint: *dst_ref


# https://schema.ocsf.io/1.1.0/classes/file_activity?extensions=win
# File System Activity [1001]
file_activity:
    device: *endpoint
    file: *file


# https://schema.ocsf.io/1.1.0/classes/base_event
# Base Event
type_uid:
    native_field: ActionType
    native_value:
        300403: # Entity Management: Update
            - "Add delegated permission grant."
        600302: # API Activity: Read
            - "Directory Services replication"
            - "LdapSearch"
            - "MailItemsAccessed"
status_id:
  - native_field: RawEventData.ResultStatus
    native_value:
        1: # Success
            - "Succeeded"
        2: # Failure
            - "Failed"
